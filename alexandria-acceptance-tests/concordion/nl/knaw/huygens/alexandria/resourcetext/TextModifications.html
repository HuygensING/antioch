<?xml version="1.0" encoding="UTF-8"?><html xmlns:c="http://www.concordion.org/2007/concordion" xmlns:h="http://huygens.knaw.nl/concordion-acceptance-test" xmlns:xsi="http://www.w3.org/1999/xhtml" xsi:schemaLocation="http://huygens.knaw.nl/concordion-acceptance-test                           http://huygensing.github.io/alexandria/xsd/concordion-rest.xsd"><head><style>* {
  font-family: Arial;
}
body {
  padding: 32px;  
}
pre {
  padding: 6px 28px 6px 28px;
  background-color: #E8EEF7;
}
pre, pre *, code, code *, kbd {
  font-family: Courier New, Courier;
  font-size: 10pt;
}
h1, h1 * {
  font-size: 24pt;	
}
p, td, th, li, .breadcrumbs {
  font-size: 10pt;
}
p, li {
  line-height: 140%;
  max-width: 720px;
}
table {
  border-collapse: collapse;
  empty-cells: show;
  margin: 8px 0px 8px 0px;
}
th, td {
  border: 1px solid black;
  padding: 3px;
}
td {
  background-color: white;
  vertical-align: top;
}
th {
  background-color: #C3D9FF;
}
li {
  margin-top: 6px;
  margin-bottom: 6px; 
}

.example {
  padding: 6px 16px 6px 16px;
  border: 1px solid #C3D9FF;
  margin: 6px 0px 28px 0px;
  background-color: #F5F9FD;
}
.example h3 {
  margin-top: 8px;
  margin-bottom: 8px;
  font-size: 12pt;
}

p.success {
  padding: 2px;
}
.success, .success * {
  background-color: #afa !important;
}
.success pre {
  background-color: #bbffbb;
}
.failure, .failure * {
  background-color: #ffb0b0;
  padding: 1px;
}
.failure .expected {
  text-decoration: line-through;
  color: #bb5050;
}
.ignored, .ignored * {
  background-color: #f0f0f0 !important;	
}

ins {
  text-decoration: none;	
}

.exceptionMessage {
  background-color: #fdd;
  font-family: Courier New, Courier, Monospace;
  font-size: 10pt;
  display: block;
  font-weight: normal;
  padding: 4px;
  text-decoration: none !important;
}
.stackTrace, .stackTrace * {
  font-weight: normal;
}
.stackTrace {
  display: none;
  padding: 1px 4px 4px 4px;
  background-color: #fdd;
  border-top: 1px dotted black;
}
.stackTraceExceptionMessage {
  display: block;
  font-family: Courier New, Courier, Monospace;
  font-size: 8pt;
  white-space: wrap;
  padding: 1px 0px 1px 0px;
}
.stackTraceEntry {
  white-space: nowrap;
  font-family: Courier New, Courier, Monospace;
  display: block;
  font-size: 8pt;
  padding: 1px 0px 1px 32px;
}
.stackTraceButton {
  font-size: 8pt;
  margin: 2px 8px 2px 0px;
  font-weight: normal;
  font-family: Arial;
}

.special {
  font-style: italic;
}
.missing, .missing * {
  background-color: #ff9999;
  color:#bb5050;
  text-decoration: line-through;
}
.surplus, .surplus * {
  background-color: #ff9999;
}
.footer {
  text-align: right;
  margin-top: 40px;
  font-size: 8pt;
  width: 100%;
  color: #999;
}
.footer .testTime {
  padding: 2px 10px 0px 0px;
}

.idea {
  font-size: 9pt;
  color: #888;
  font-style: italic;	
}
.tight li {
  margin-top: 1px;
  margin-bottom: 1px; 
}
.commentary {
  float: right;
  width: 200px;
  background-color: #ffffd0;
  padding:8px;
  border: 3px solid #eeeeb0;	 
  margin: 10px 0px 10px 10px;	 
}
.commentary, .commentary * {
  font-size: 8pt;
}
</style><meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<title>Alexandria: Modifying the text</title>

<link type="text/css" rel="stylesheet" href="../../../../../codemirror/codemirror.css" /><link type="text/css" rel="stylesheet" href="../../../../../codemirror/enable-codemirror.css" /><link type="text/css" rel="stylesheet" href="../../../../../codemirror/merge.css" /><script type="text/javascript" src="../../../../../codemirror/codemirror.js"></script><script type="text/javascript" src="../../../../../codemirror/javascript.js"></script><script type="text/javascript" src="../../../../../codemirror/diff_match_patch.js"></script><script type="text/javascript" src="../../../../../codemirror/merge.js"></script><script type="text/javascript" src="../../../../../codemirror/enable-codemirror.js"></script><link type="text/css" rel="stylesheet" href="../../../../../bootstrap/bootstrap.css" /><link type="text/css" rel="stylesheet" href="../../../../../bootstrap/enable-bootstrap.css" /><script type="text/javascript" src="../../../../../jquery/jquery.min.js"></script><script type="text/javascript" src="../../../../../bootstrap/bootstrap.min.js"></script></head><body><span class="breadcrumbs"><a href="../Alexandria.html">Alexandria</a> &gt;</span>
































<div class="container"><div class="jumbotron"><h1>Modifying text annotations</h1></div><div class="row"><div class="col-md-3"><ul class="nav nav-pills nav-stacked"><li class="active"><a href="#annotate-text" data-toggle="tab">1) How can I add unique identifiers to certain elements in certain resource texts?</a></li><li><a href="#add-elements" data-toggle="tab">2) How can I wrap the contents of a text element with a given xml:id in a new element for a set of xml:ids for a given resource text?</a></li><li><a href="#annotate-text-1" data-toggle="tab">3) How can I create a text annotation?</a></li><li><a href="#annotate-text-2" data-toggle="tab">4) What happens when I refer to an undefined xml:id when creating a text annotation?</a></li><li><a href="#annotate-text-3" data-toggle="tab">5) What happens when I use an invalid offset when creating a text annotation?</a></li><li><a href="#annotate-text-4" data-toggle="tab">6) What happens when I use an invalid offset/length combination when creating a text annotation?</a></li><li><a href="#annotate-text-5" data-toggle="tab">7) What happens when I use an invalid annotation name when creating a text annotation?</a></li><li><a href="#annotate-text-7" data-toggle="tab">8) What happens when I use an invalid responsibility value when creating a text annotation?</a></li><li><a href="#annotate-text-8" data-toggle="tab">9) What happens when I fail to specify a responsibility when creating a text annotation?</a></li><li><a href="#annotate-text-9" data-toggle="tab">10) How do I retrieve the text with a specific annotation?</a></li><li><a href="#annotate-text-10" data-toggle="tab">11) How do I create a non-overlapping text annotation?</a></li><li><a href="#annotate-text-11" data-toggle="tab">12) How do I create an overlapping text annotation?</a></li></ul></div><div class="col-md-9"><div class="tab-content"><div id="annotate-text" c:execute="clearStorage()" class="tab-pane fade active in"><div class="panel panel-default"><div class="panel-heading"><strong>1) How can I add unique identifiers to certain elements in certain resource texts?</strong></div><div class="panel-body">
     
   Given a resource
   with id <code c:set="#resId1">00000000-0000-0000-0000-000000000001</code>
   <span c:execute="resourceExists(#resId1)">exists</span>,<br />
   which has
   <span c:execute="resourceHasText(#resId1,#text1)">text<br />
     <code c:set="#text1">&lt;body&gt;&lt;div&gt;&lt;p&gt;First paragraph&lt;/p&gt;&lt;/div&gt;&lt;div xml:id="div-1"&gt;&lt;p&gt;Second paragraph&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;</code>
   </span>,<br />
   <br />

   a second resource
   with id <code c:set="#resId2">00000000-0000-0000-0000-000000000002</code>
   <span c:execute="resourceExists(#resId2)">exists</span>,<br />
   which has
   <span c:execute="resourceHasText(#resId2,#text2)">text<br />
      <code c:set="#text2">&lt;body&gt;&lt;div&gt;&lt;p&gt;Lorem ipsum&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;</code>
   </span>,<br />
   <br />
      
   and a third resource
   with id <code c:set="#resId3">00000000-0000-0000-0000-000000000003</code>
   <span c:execute="resourceExists(#resId3)">exists</span>,
   which has
   <span c:execute="resourceHasText(#resId3,#text3)">text<br />
      <code c:set="#text3">&lt;body&gt;&lt;div&gt;&lt;p&gt;Mei mazim iriure ancillae ut.&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;</code>
   </span>
  <br />
  <br />

	<div h:request="">
	   If i now
	   <code class="post">/commands/add-unique-id</code>
	   the body:
	   <pre class="json">{
  "resourceIds" : [ "00000000-0000-0000-0000-000000000001", "00000000-0000-0000-0000-000000000002" ],
  "elements" : [ "div", "p" ]
}</pre>
	   using
	   <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
	   then I should receive
	   <ul>
	     <li>status <code h:status="" class="success">200 OK</code></li>
	     <li>and the response body is
	     <pre class="json rest-success">{
  "errorLines" : [ ],
  "parametersAreValid" : true
}</pre>
	     </li>
	   </ul>
	</div>
	<br />
	
  <div h:request="">
     Then a
     <code class="get">/resources/00000000-0000-0000-0000-000000000001/text/xml</code><br />
     using
     <code name="Accept" h:setHeader="" class="set-header">text/xml</code><br />
     yields response body:<br />
     <pre class="xml rest-success">&lt;body&gt;
  &lt;div xml:id="div-2"&gt;
    &lt;p xml:id="p-1"&gt;First paragraph&lt;/p&gt;
  &lt;/div&gt;
  &lt;div xml:id="div-1"&gt;
    &lt;p xml:id="p-2"&gt;Second paragraph&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;
</pre>
     <small>(formatting added for increased readability)</small><br />
     Note: elements that already had an xml:id kept this xml:id, and existing xml:ids were not used again. 
  </div>
  <br />
	
  <div h:request="">
     And
     <code class="get">/resources/00000000-0000-0000-0000-000000000002/text/xml</code>
     using
     <code name="Accept" h:setHeader="" class="set-header">text/xml</code><br />
     yields response body:<br />
     <pre class="xml rest-success">&lt;body&gt;
  &lt;div xml:id="div-1"&gt;
    &lt;p xml:id="p-1"&gt;Lorem ipsum&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;
</pre>
     <small>(formatting added for increased readability)</small><br />
  </div>
  <br />
     
  <div h:request="">
     Finally,
     <code class="get">/resources/00000000-0000-0000-0000-000000000003/text/xml</code>
     using
     <code name="Accept" h:setHeader="" class="set-header">text/xml</code><br />
     yields response body:<br />
     <pre class="xml rest-success">&lt;body&gt;
  &lt;div&gt;
    &lt;p&gt;Mei mazim iriure ancillae ut.&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;
</pre>
     <small>(formatting added for increased readability)</small><br />
     (Since this resource was not part of resourceIds, it has not been modified.)
  </div>
     
</div></div></div><div id="add-elements" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>2) How can I wrap the contents of a text element with a given xml:id in a new element for a set of xml:ids for a given resource text?</strong></div><div class="panel-body">
     
    Given a resource
    with id <code c:set="#resId1">00000000-0000-0000-0000-000000000001</code>
    <span c:execute="resourceExists(#resId1)">exists</span>,<br />
    which has
    <span c:execute="resourceHasText(#resId1,#text1)">text<br />
      <code c:set="#text1">&lt;body&gt;&lt;div xml:id="div-1"&gt;&lt;p xml:id="p-1"&gt;First paragraph&lt;/p&gt;&lt;/div&gt;&lt;div xml:id="div-2"&gt;&lt;p xml:id="p-2"&gt;Second paragraph&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;</code>
    </span>
    <br />
    <br />
     
  <div h:request="">
     If i now
     <code class="post">/commands/wrap-content-in-element</code>
     the body:
     <pre class="json">{
  "resourceIds" : [ "00000000-0000-0000-0000-000000000001" ],
  "xmlIds" : [ "div-1", "p-2" ],
  "element" : {
    "name" : "hi",
    "attributes" : {
      "rend" : "italic"
    }
  }
}</pre>
     using
     <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
     then I should receive
     <ul>
       <li>status <code h:status="" class="success">200 OK</code></li>
       <li>and the response body is
       <pre class="json rest-success">{
  "errorLines" : [ ],
  "parametersAreValid" : true
}</pre>
       </li>
     </ul>
  </div>
  <br />

  <div h:request="">
     Then a
     <code class="get">/resources/00000000-0000-0000-0000-000000000001/text/xml</code><br />
     using
     <code name="Accept" h:setHeader="" class="set-header">text/xml</code><br />
     yields response body:<br />
     <pre class="xml rest-success">&lt;body&gt;
  &lt;div xml:id="div-1"&gt;
    &lt;hi rend="italic"&gt;
      &lt;p xml:id="p-1"&gt;First paragraph&lt;/p&gt;
    &lt;/hi&gt;
  &lt;/div&gt;
  &lt;div xml:id="div-2"&gt;
    &lt;p xml:id="p-2"&gt;
      &lt;hi rend="italic"&gt;Second paragraph&lt;/hi&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;
</pre>
     <small>(formatting added for increased readability)</small><br />
  </div>
  <br />
</div></div></div><div id="annotate-text-1" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>3) How can I create a text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a simple paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
		When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
		the body:
		<pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 6,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">201 Created</code></li>
      <li>location header
          <code class="location success">https://{host}/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
      </li>
      <li>and the response body is
      <pre class="json rest-success">{
  "textAnnotationInfo" : {
    "annotates" : "is"
  }
}</pre> 
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-2" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>4) What happens when I refer to an undefined xml:id when creating a text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a simple paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "undefined",
      "offset" : 5,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">400 Bad Request</code></li>
      <li>and the response body contains:
        <pre class="json rest-success">{
  "error" : {
    "message" : "The text does not contain an element with the specified xml:id."
  }
}</pre>
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-3" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>5) What happens when I use an invalid offset when creating a text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a simple paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "p-1",
      "offset" : -1,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">400 Bad Request</code></li>
      <li>and the response body contains:
        <pre class="json rest-success">{
  "error" : {
    "message" : "The specified offset/length is illegal."
  }
}</pre>
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-4" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>6) What happens when I use an invalid offset/length combination when creating a text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a simple paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 5,
      "length" : 100
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">400 Bad Request</code></li>
      <li>and the response body contains:
        <pre class="json rest-success">{
  "error" : {
    "message" : "The specified offset/length is illegal."
  }
}</pre>
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-5" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>7) What happens when I use an invalid annotation name when creating a text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a simple paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "!@#$%^&amp;*",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 5,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">400 Bad Request</code></li>
      <li>and the response body contains:
        <pre class="json rest-success">{
  "error" : {
    "message" : "The specified annotation name is illegal."
  }
}</pre>
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-7" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>8) What happens when I use an invalid responsibility value when creating a text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a simple paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "!@#$%^&amp;*",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 5,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">400 Bad Request</code></li>
      <li>and the response body contains:
        <pre class="json rest-success">{
  "error" : {
    "message" : "Resource has no annotator with code '!@#$%^&amp;*'."
  }
}</pre>
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-8" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>9) What happens when I fail to specify a responsibility when creating a text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a simple paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 5,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">400 Bad Request</code></li>
      <li>and the response body contains:
        <pre class="json rest-success">{
  "error" : {
    "message" : "No annotator specified."
  }
}</pre>
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-9" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>10) How do I retrieve the text with a specific annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 6,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">201 Created</code></li>
      <li>and the response body is
      <pre class="json rest-success">{
  "textAnnotationInfo" : {
    "annotates" : "is"
  }
}</pre> 
      </li>
    </ul>
  </div>
  <br />
  <div h:request="">
    When I <span h:success="" class="success">successfully</span> define a view <code c:set="#view">word-ed</code> by
    <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/views/word-ed</code>
    the body:
    <pre class="json">{
  "textView" : {
    "description" : "Word annotations with responsibility #ed",
    "elements" : {
      "word" : {
        "elementMode" : "hideTag",
        "when" : "attribute(resp).isNot('#ed')"
      }
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
  </div>
  <br />
  <div h:request="">
    Then a
      <code class="get">/resources/00000000-0000-0000-0000-000000000003/text/xml?view=word-ed</code><br />
    using
    <code name="Accept" h:setHeader="" class="set-header">text/xml</code><br />
    <span h:success="" class="success">successfully</span>
    yields response body:
    <pre class="xml rest-success">&lt;text&gt;
  &lt;p xml:id="p-1"&gt;This &lt;word resp="#ed"&gt;is&lt;/word&gt; a paragraph.&lt;/p&gt;
&lt;/text&gt;
</pre>
     <small>(formatting added for increased readability)</small><br />
  </div>
</div></div></div><div id="annotate-text-10" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>11) How do I create a non-overlapping text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 6,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">201 Created</code></li>
      <li>and the response body is
      <pre class="json rest-success">{
  "textAnnotationInfo" : {
    "annotates" : "is"
  }
}</pre> 
      </li>
    </ul>
  </div>
  <br />
  <div h:request="">
    When I then <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000005</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 9,
      "length" : 1
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">201 Created</code></li>
      <li>and the response body is
      <pre class="json rest-success">{
  "textAnnotationInfo" : {
    "annotates" : "a"
  }
}</pre> 
      </li>
    </ul>
  </div>
</div></div></div><div id="annotate-text-11" c:execute="clearStorage()" class="tab-pane fade"><div class="panel panel-default"><div class="panel-heading"><strong>12) How do I create an overlapping text annotation?</strong></div><div class="panel-body">
  Given a resource
  with id <code c:set="#resourceId">00000000-0000-0000-0000-000000000003</code>
  <span c:execute="resourceExists(#resourceId)">exists</span>,<br />
  which has
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode,#annotatorDescription)">an annotator
  with code <code c:set="#annotatorCode">ed1</code> and description <code c:set="#annotatorDescription">Mr. Ed</code>  
  </span>, and
  <span c:execute="resourceHasAnnotator(#resourceId,#annotatorCode2,#annotatorDescription2)">an annotator
  with code <code c:set="#annotatorCode2">ed2</code> and description <code c:set="#annotatorDescription2">Mrs. Ed</code>  
  </span>, and
  <span c:execute="resourceHasText(#resourceId,#text)">text<br />
    <code c:set="#text">&lt;text&gt;&lt;p xml:id="p-1"&gt;This is a paragraph.&lt;/p&gt;&lt;/text&gt;</code>
  </span>,<br />
  <br />
  <div h:request="">
    When I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000004</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed1",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 6,
      "length" : 2
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">201 Created</code></li>
      <li>and the response body is
      <pre class="json rest-success">{
  "textAnnotationInfo" : {
    "annotates" : "is"
  }
}</pre> 
      </li>
    </ul>
  </div>
  <br />
  <div h:request="">
    When I then <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000005</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed1",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 7,
      "length" : 1
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code>,<br />
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">409 Conflict</code></li>
      <li>and the response body contains:
        <pre class="json rest-success">{
  "error" : {
    "message" : "Overlapping annotations with the same name and responsibility."
  }
}</pre>
      </li>
    </ul>
  </div>
  <br />
  <div h:request="">
    However, when I <code class="put">/resources/00000000-0000-0000-0000-000000000003/text/annotations/00000000-0000-0000-0000-000000000005</code>
    the body:
    <pre class="json">{
  "textAnnotation" : {
    "name" : "word",
    "annotator" : "ed2",
    "position" : {
      "xml:id" : "p-1",
      "offset" : 7,
      "length" : 1
    }
  }
}</pre>
    using
    <code name="Content-Type" h:setHeader="" class="set-header">application/json</code><br />
    (note that I use a different responsibility),
    then I should receive
    <ul>
      <li>status <code h:status="" class="success">201 Created</code></li>
      <li>and the response body is
      <pre class="json rest-success">{
  "textAnnotationInfo" : {
    "annotates" : "s"
  }
}</pre> 
      </li>
    </ul>
  </div>
</div></div></div></div></div></div></div><div class="footer">Results generated by <a href="http://www.concordion.org" style="font-weight: bold; text-decoration: none; color: #89C;">Concordion</a><div class="testTime">in 1327 ms on 14-Jun-2016 at 11:50:15 CEST</div></div></body>
</html>